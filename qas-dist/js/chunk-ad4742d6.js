(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad4742d6"],{2388:function(e,t,n){"use strict";var a=n("c953"),r="/company-management",o=function(){return a["a"].get(r)},i=function(e){return a["a"].post(r,e)},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return a["a"].put(r+"/".concat(e),t)},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return a["a"].put(r+"/".concat(e,"/activate"),t)},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return a["a"].put(r+"/".concat(e,"/deactivate"),t)};t["a"]={get:o,add:i,update:c,activate:l,deactivate:u}},2611:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("8afd");function r(){return{$show:Object(a["e"])("$messageBox"),$prompt:Object(a["e"])("$prompt"),$alert:Object(a["e"])("$alert"),$confirm:Object(a["e"])("$confirm")}}},"30dd":function(e,t,n){"use strict";var a=n("c953"),r=function(e){return a["a"].post("/tonnage-allocations",e)},o=function(e){return a["a"].get("/get-allocation/tonnage".concat(e))};t["a"]={setAllocation:r,getAllocation:o}},"56dd":function(e,t,n){"use strict";var a=n("5530"),r=n("c953"),o=function(e){return r["a"].post("/registration-periods",Object(a["a"])({},e))},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return r["a"].put("registration-periods/".concat(e),{data:t})},c=function(){return r["a"].get("/registration-periods/get-active")},l=function(){return r["a"].get("/registration-periods")},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r["a"].put("registration-periods/".concat(e,"/activate"))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r["a"].put("registration-periods/".concat(e,"/deactivate"))},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r["a"].get("registration-periods/get-period/".concat(e))};t["a"]={create:o,update:i,getActive:c,getAll:l,activate:u,deactivate:d,searchPeriodId:s}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var a=n("1d80"),r=n("577e"),o=n("5899"),i="["+o+"]",c=RegExp("^"+i+i+"*"),l=RegExp(i+i+"*$"),u=function(e){return function(t){var n=r(a(t));return 1&e&&(n=n.replace(c,"")),2&e&&(n=n.replace(l,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},7156:function(e,t,n){var a=n("1626"),r=n("861d"),o=n("d2bb");e.exports=function(e,t,n){var i,c;return o&&a(i=t.constructor)&&i!==n&&r(c=i.prototype)&&c!==n.prototype&&o(e,c),e}},"8cbe":function(e,t,n){"use strict";var a=n("c953"),r=function(){return a["a"].get("/regions")},o=function(){return a["a"].get("/producer")};t["a"]={getRegions:r,getProducers:o}},a9e3:function(e,t,n){"use strict";var a=n("83ab"),r=n("da84"),o=n("94ca"),i=n("6eeb"),c=n("5135"),l=n("c6b6"),u=n("7156"),d=n("d9b5"),s=n("c04e"),p=n("d039"),b=n("7c73"),f=n("241c").f,m=n("06cf").f,g=n("9bf2").f,O=n("58a8").trim,j="Number",v=r[j],h=v.prototype,k=l(b(h))==j,w=function(e){if(d(e))throw TypeError("Cannot convert a Symbol value to a number");var t,n,a,r,o,i,c,l,u=s(e,"number");if("string"==typeof u&&u.length>2)if(u=O(u),t=u.charCodeAt(0),43===t||45===t){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+u}for(o=u.slice(2),i=o.length,c=0;c<i;c++)if(l=o.charCodeAt(c),l<48||l>r)return NaN;return parseInt(o,a)}return+u};if(o(j,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var D,x=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof x&&(k?p((function(){h.valueOf.call(n)})):l(n)!=j)?u(new v(w(t)),n,x):w(t)},V=a?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),C=0;V.length>C;C++)c(v,D=V[C])&&!c(x,D)&&g(x,D,m(v,D));x.prototype=h,h.constructor=x,i(r,j,x)}},d81d:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").map,o=n("1dde"),i=o("map");a({target:"Array",proto:!0,forced:!i},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},eeae:function(e,t,n){"use strict";var a=n("c953"),r=function(e){return a["a"].post("/distributor-allocations",e)},o=function(e){return a["a"].get("/get-allocation/distributor".concat(e))},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a["a"].post("/distributor-allocations/".concat(t,"/is-allocation-full"),e)};t["a"]={setAllocation:r,getAllocation:o,isAllocationFull:i}},fb27:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return g}));n("99af");var a=n("c953"),r="/distributor-regions",o=function(){return a["a"].get(r+"/regions")},i=function(){return a["a"].get(r+"/regions_by_vp")},c=function(){return a["a"].get(r+"/regions_by_wilayah")},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a["a"].get(r+"/regions_by_anper/".concat(e))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a["a"].get(r+"/regions-province/".concat(e))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a["a"].get(r+"/regions-province-anper/".concat(e,"/").concat(t))},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a["a"].get(r+"/producer-area/".concat(e))},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a["a"].get(r+"/producer-area-anper/".concat(e,"/").concat(t))},b=function(e){return a["a"].post(r,e)},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return a["a"].put(r+"/".concat(e),t)},m=function(e){return a["a"].delete(r+"/".concat(e))},g=function(e){return a["a"].post(r+"/".concat(e,"/verify"))};t["a"]={regions:o,regions_by_vp:i,regions_by_wilayah:c,regions_by_anper:l,regionProvinces:u,regionProvincesAnper:d,regionProducerArea:s,regionProducerAreaAnper:p,addDistributorRegions:b,updateDistributorRegions:f,deleteDistributorRegion:m,verifyDistributorRegion:g}},fcc4:function(e,t,n){"use strict";n.r(t);var a=n("7a23");function r(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("distributor-allocation"),l=Object(a["resolveComponent"])("tonnage-allocation");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(c),Object(a["createVNode"])(l,{class:"mt-5"})],64)}var o=n("8afd"),i=n("c45b"),c=(n("4de4"),n("b0c0"),{class:"p-5"}),l=Object(a["createVNode"])("p",null,"Periode Registrasi:",-1),u={class:"mb-4"},d={key:0},s={class:"grid grid-cols-3 gap-4 mb-4"},p=Object(a["createVNode"])("label",{for:"propinsi"},"Propinsi",-1),b={class:"text-base"},f=Object(a["createVNode"])("label",{for:"kabupaten"},"Kabupaten",-1),m={class:"text-base"},g=Object(a["createVNode"])("div",{class:"border border-b-0 mb-4"},null,-1),O={class:"grid grid-cols-1 gap-4"},j=Object(a["createVNode"])("label",{for:"produsen"},"Total Alokasi Distributor",-1),v={class:"dialog-footer"},h=Object(a["createTextVNode"])("Cancel"),k=Object(a["createTextVNode"])("Confirm");function w(e,t,n,r,o,i){var w=Object(a["resolveComponent"])("el-option"),D=Object(a["resolveComponent"])("el-select"),x=Object(a["resolveComponent"])("data-grid"),V=Object(a["resolveComponent"])("el-tab-pane"),C=Object(a["resolveComponent"])("import-allocation"),_=Object(a["resolveComponent"])("el-tabs"),N=Object(a["resolveComponent"])("el-button"),y=Object(a["resolveComponent"])("el-dialog"),I=Object(a["resolveComponent"])("document-form"),P=Object(a["resolveDirective"])("loading");return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createBlock"])(I,{title:"Rencana Alokasi Distributor"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("div",c,[l,Object(a["createVNode"])("div",u,[Object(a["createVNode"])(D,{class:"form-control",modelValue:e.filter.periodId,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.filter.periodId=t})},{default:Object(a["withCtx"])((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.registrationPeriods,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(w,{key:e.id,value:e.id,label:e.period},null,8,["value","label"])})),128))]})),_:1},8,["modelValue"])]),Object(a["createVNode"])(_,{type:"border-card"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(V,{label:"Sudah Dialokasikan",class:"pb-10"},{default:Object(a["withCtx"])((function(){return[null!=e.filter.periodId?(Object(a["openBlock"])(),Object(a["createBlock"])(x,{key:0,ref:"allocatedDataGrid",allocated:1,registrationPeriodId:e.filter.periodId},null,8,["registrationPeriodId"])):Object(a["createCommentVNode"])("",!0)]})),_:1}),"svp_pso_admin"!=e.user.role.name?(Object(a["openBlock"])(),Object(a["createBlock"])(V,{key:0,label:"Belum Dialokasikan",class:"pb-10"},{default:Object(a["withCtx"])((function(){return[null!=e.filter.periodId?(Object(a["openBlock"])(),Object(a["createBlock"])(x,{key:0,ref:"unallocatedDataGrid",onOpenAllocationFormDialog:e.openAllocationFormDialog,allocated:0,registrationPeriodId:e.filter.periodId},null,8,["onOpenAllocationFormDialog","registrationPeriodId"])):Object(a["createCommentVNode"])("",!0)]})),_:1})):Object(a["createCommentVNode"])("",!0),"svp_pso_admin"!=e.user.role.name?(Object(a["openBlock"])(),Object(a["createBlock"])(V,{key:1,label:"Import Alokasi",class:"pb-10"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(C)]})),_:1})):Object(a["createCommentVNode"])("",!0)]})),_:1})]),Object(a["createVNode"])(y,{"append-to-body":"",title:"Tetapkan alokasi distributor",modelValue:e.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.dialogVisible=t}),width:"50%"},{footer:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("span",v,[Object(a["createVNode"])(N,{onClick:t[3]||(t[3]=function(t){return e.dialogVisible=!1})},{default:Object(a["withCtx"])((function(){return[h]})),_:1}),Object(a["createVNode"])(N,{type:"primary",onClick:e.submitAllocationForm},{default:Object(a["withCtx"])((function(){return[k]})),_:1},8,["onClick"])])]})),default:Object(a["withCtx"])((function(){return[null!=e.dialogData?(Object(a["openBlock"])(),Object(a["createBlock"])("div",d,[Object(a["createVNode"])("div",s,[Object(a["createVNode"])("div",null,[p,Object(a["createVNode"])("p",b,Object(a["toDisplayString"])(e.dialogData.province.province_name),1)]),Object(a["createVNode"])("div",null,[f,Object(a["createVNode"])("p",m,Object(a["toDisplayString"])(e.dialogData.city.city_type)+" "+Object(a["toDisplayString"])(e.dialogData.city.city_name),1)])]),g,Object(a["createVNode"])("div",O,[Object(a["createVNode"])("div",null,[j,Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.dialogFormData.allocation=t}),class:"form-control mt-2"},null,512),[[a["vModelText"],e.dialogFormData.allocation]])])])])):Object(a["createCommentVNode"])("",!0)]})),_:1},8,["modelValue"])]})),_:1},512)),[[P,e.loading]])}n("0cfa");var D=n("5040"),x=n.n(D),V=n("1da1"),C=(n("96cf"),n("7db0"),n("a9e3"),n("2022"));function _(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("DxFilterRow"),l=Object(a["resolveComponent"])("DxColumn"),u=Object(a["resolveComponent"])("DxPaging"),d=Object(a["resolveComponent"])("DxPager"),s=Object(a["resolveComponent"])("DxDataGrid");return Object(a["openBlock"])(),Object(a["createBlock"])(s,{ref:"root","data-source":e.customStore,"show-borders":!0,"remote-operations":{paging:!0,filtering:!0,sorting:!1},selection:{mode:"single"},onSelectionChanged:e.onSelectionChanged,onToolbarPreparing:t[1]||(t[1]=function(t){return e.onToolbarPreparing(t)})},{propinsiCellTemplate:Object(a["withCtx"])((function(e){var t=e.data;return[Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(t.data.province.province_name),1)]})),kabupatenKotaCellTemplate:Object(a["withCtx"])((function(e){var t=e.data;return[Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(t.data.city.city_type)+" "+Object(a["toDisplayString"])(t.data.city.city_name),1)]})),cellTemplate:Object(a["withCtx"])((function(t){var n=t.data;return[0==e.allocated?(Object(a["openBlock"])(),Object(a["createBlock"])("button",{key:0,onClick:function(t){return e.openAllocationFormDialog(n.data)},class:"btn bg-theme-4 px-4 py-2 text-white text-xs"},"Input Alokasi",8,["onClick"])):Object(a["createCommentVNode"])("",!0)]})),default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{visible:!0}),Object(a["createVNode"])(l,{"data-field":"province.province_name","data-type":"string",caption:"Propinsi","cell-template":"propinsiCellTemplate"}),Object(a["createVNode"])(l,{"data-field":"city.city_name","data-type":"string",caption:"Kabupaten\\Kota","cell-template":"kabupatenKotaCellTemplate"}),e.allocated?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0,allowFiltering:!1,"data-field":"distributor_allocation.total_distributor","data-type":"string",caption:"Total Alokasi Distributor"})):Object(a["createCommentVNode"])("",!0),e.allocated?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:1,allowFiltering:!1,"data-field":"created_at","data-type":"string",caption:"Created At"})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(l,{"data-field":"id",caption:"Action","cell-template":"cellTemplate"}),Object(a["createVNode"])(u,{"page-size":20}),Object(a["createVNode"])(d,{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20]})]})),_:1},8,["data-source","onSelectionChanged"])}n("99af"),n("fb6a"),n("caad");var N=n("d30a"),y=n("2597"),I=n.n(y),P=n("c953"),A=n("2388"),B=n("4360"),R=Object(a["defineComponent"])({components:{DxDataGrid:N["DxDataGrid"],DxColumn:N["DxColumn"],DxPaging:N["DxPaging"],DxPager:N["DxPager"],DxSorting:N["DxSorting"],DxHeaderFilter:N["DxHeaderFilter"],DxFilterRow:N["DxFilterRow"],DxMasterDetail:N["DxMasterDetail"]},props:["registrationPeriodId","allocated"],setup:function(e,t){var n=this,r=t.emit,o=Object(B["b"])(),i=Object(a["ref"])(null);Object(a["onMounted"])((function(){}));function c(e){return void 0!==e&&null!==e&&""!==e}var l=Object(a["inject"])("env"),u=new I.a({key:"city_id",load:function(t){var n="?";return["skip","take","requireTotalCount","requireGroupCount","sort","filter","totalSummary","group","groupSummary"].forEach((function(e){e in t&&c(t[e])&&(n+="".concat(e,"=").concat(JSON.stringify(t[e]),"&"))})),n=n.slice(0,-1),n+="&registration_period=".concat(e.registrationPeriodId),n+="&allocated=".concat(e.allocated),P["a"].get("".concat(l["VUE_APP_API_ENDPOINT"],"/distributor-allocations").concat(n)).then((function(e){return e.data})).catch((function(){throw"Data Loading Error"}))}}),d=function(e){e.selectedRowsData},s=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A["a"].activate(t).then((function(e){x.a.success({title:"Success",position:"bottom-right"}),b()})).catch((function(e){x.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A["a"].deactivate(t).then((function(e){x.a.success({title:"Success",position:"bottom-right"}),b()})).catch((function(e){x.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){i.value.instance.refresh()},f=function(){i.value.instance.clearSelection()},m=function(e){e.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"refresh",onClick:b.bind(n)}})},g=o.state.auth.user,O=function(t){return["svp_region","svp_pso_planning_management","sevp_marketing_ops","marketing_director"].includes(g.role.name)?{name:"admin-document-verification.distributor-profile.document-verification",params:{distributor_id:t.data.distributor_id},query:{registration_period:e.registrationPeriodId}}:{name:"admin-document-verification.bundle",params:{distributor_id:t.data.distributor_id},query:{registration_period:e.registrationPeriodId}}},j=function(e){r("openAllocationFormDialog",e)};return{customStore:u,onSelectionChanged:d,activate:s,deactivate:p,onToolbarPreparing:m,refreshDataGrid:b,clearSelection:f,root:i,linkToProcessDocument:O,openAllocationFormDialog:j}}}),S=n("6b0d"),F=n.n(S);const T=F()(R,[["render",_]]);var E=T,G={class:"p-5"},U={class:"mt-3"},M={class:"sm:grid grid-cols-2 gap-5"},K={class:"mb-4"},L=Object(a["createTextVNode"])("Click to upload"),$={class:"flex w-full px-5"},q={class:"ml-auto"};function z(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("el-option"),l=Object(a["resolveComponent"])("el-select"),u=Object(a["resolveComponent"])("form-item"),d=Object(a["resolveComponent"])("el-button"),s=Object(a["resolveComponent"])("el-upload"),p=Object(a["resolveDirective"])("loading");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])("div",G,[Object(a["createVNode"])("div",U,[Object(a["createVNode"])("div",M,[Object(a["createVNode"])(u,{label:"Periode Alokasi",validationData:e.validate.periodId},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("div",K,[Object(a["withDirectives"])(Object(a["createVNode"])(l,{class:"form-control",modelValue:e.formData.periodId,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.formData.periodId=t})},{default:Object(a["withCtx"])((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.registrationPeriods,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{key:e.id,value:e.id,label:e.period},null,8,["value","label"])})),128))]})),_:1},8,["modelValue"]),[[p,e.loadingPeriod]])])]})),_:1},8,["validationData"]),Object(a["createVNode"])(u,{label:"File Alokasi Distributor",validationData:e.validate.file_path},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(s,{ref:"elUpload",class:"upload-demo",action:e.env["VUE_APP_API_ENDPOINT"]+"/files",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},"with-credentials":!0,"on-success":e.onUploadSuccees,"file-list":null!=e.formData.file_path?[{name:"file-import-alokasi",url:e.formData.file_path}]:[],"on-preview":e.handlePreview},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(d,{size:"small",type:"primary"},{default:Object(a["withCtx"])((function(){return[L]})),_:1})]})),_:1},8,["action","on-success","file-list","on-preview"])]})),_:1},8,["validationData"])])])]),Object(a["createVNode"])("div",$,[Object(a["createVNode"])("div",q,[Object(a["withDirectives"])(Object(a["createVNode"])("button",{type:"button",class:"btn btn-primary w-24 mr-2",onClick:t[2]||(t[2]=function(){return e.add&&e.add.apply(e,arguments)})}," Add ",512),[[p,e.loading]])])])],64)}var H=n("ade3"),X=n("5530"),J=(n("d3b7"),{periodId:null,file_path:null}),W=n("25a0"),Y=n("e3e1"),Q=n("5502"),Z=n("56dd"),ee=function(e){return P["a"].post("/read-allocation/distributor",e)},te=function(e){return P["a"].post("/read-allocation/tonnage",e)},ne={read_distributor:ee,read_tonnage:te},ae=n("2611"),re=Object(a["defineComponent"])({components:{DocumentForm:i["a"],FormItem:C["a"]},setup:function(){var e,t=Object(Q["d"])(),n=(t.state.auth.user,Object(a["ref"])(!1)),r=Object(a["ref"])(!1),o=Object(ae["a"])(),i=Object(a["ref"])(null),c=Object(a["inject"])("env"),l=Object(a["ref"])([]),u=Object(a["reactive"])(Object(X["a"])({},J)),d={periodId:{required:Y["c"]},file_path:{required:Y["c"]}},s=Object(W["a"])(d,Object(a["toRefs"])(u));Object(a["onMounted"])(Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.value=!0,r.value=!0,e.next=4,Z["a"].getAll().then((function(e){if(l.value=e.data.data,l.value.length){var t=l.value.find((function(e){return e.active}));t&&(u.periodId=t.id)}})).finally((function(){n.value=!1,r.value=!1}));case 4:case"end":return e.stop()}}),e)}))));var p=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s.value.$touch(),s.value.$invalid?x.a.error({title:"Submit Gagal",message:"Silahkan periksa form sekali lagi",position:"bottom-right"}):o.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.value=!0,e.next=3,ne.read_distributor(u).then((function(e){i.value.clearFiles(),m(),x.a.success({title:"Data berhasil disimpan",position:"bottom-right"})})).catch((function(e){x.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})})).finally((function(){n.value=!1}));case 3:case"end":return e.stop()}}),e)})))).catch((function(){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e,t,n){u.file_path=e.id},f=function(e){var t=window.open(c["VUE_APP_API_ENDPOINT"]+"/files?filePath="+e.url,"_blank");t.focus()},m=function(){u["file_path"]=null,s.value.$reset()};return e={env:c,formData:u,validate:s,loading:n,loadingPeriod:r,add:p},Object(H["a"])(e,"add",p),Object(H["a"])(e,"onUploadSuccees",b),Object(H["a"])(e,"elUpload",i),Object(H["a"])(e,"handlePreview",f),Object(H["a"])(e,"registrationPeriods",l),e}});const oe=F()(re,[["render",z]]);var ie=oe,ce=n("8cbe"),le=n("fb27"),ue=n("eeae"),de=Object(o["c"])({components:{DocumentForm:i["a"],DataGrid:E,FormItem:C["a"],importAllocation:ie},setup:function(){var e=Object(o["p"])(!1),t=Object(o["o"])({id:null,period:null}),n=Object(o["p"])([]),a=Object(o["p"])([]),r=Object(o["p"])([]),i=Object(o["p"])([]),c=Object(o["p"])([]),l=Object(o["p"])(!1),u=Object(o["p"])(null),d=Object(o["o"])({allocation:0}),s=Object(ae["a"])(),p=Object(o["p"])(null),b=Object(o["p"])(null),f=Object(Q["d"])(),m=f.state.auth.user,g=Object(o["o"])({periodId:-1,producerId:-1,regionId:-1,provinceId:-1,cityId:-1});Object(o["m"])(Object(V["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.value=!0,t.next=3,Z["a"].getAll().then((function(e){if(n.value=e.data.data,n.value.length){var t=n.value.find((function(e){return e.active}));t&&(g.periodId=t.id)}}));case 3:return t.next=5,ce["a"].getProducers().then((function(e){a.value=e.data}));case 5:e.value=!1;case 6:case"end":return t.stop()}}),t)}))));var O=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==g.producerId){e.next=4;break}return e.next=3,le["a"].regions(g.producerId).then((function(e){r.value=e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==g.regionId){e.next=4;break}return e.next=3,le["a"].regionProvinces(g.regionId).then((function(e){i.value=e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==g.provinceId){e.next=4;break}return e.next=3,le["a"].regionProducerArea(g.provinceId).then((function(e){c.value=e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",g);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(e){l.value=!0,u.value=e},w=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(V["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=u.value,n=t.province_id,a=t.city_id,e.next=3,ue["a"].setAllocation({registration_period_id:g.periodId,province_id:n,city_id:a,total_distributor:Number(d.allocation)}).then((function(e){b.value.refreshDataGrid(),p.value.refreshDataGrid(),x.a.success({title:"Data berhasil disimpan",position:"bottom-right"})})).catch((function(e){x.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})}));case 3:d.allocation=0,u.value=null,l.value=!1;case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{registrationPeriod:t,registrationPeriods:n,loading:e,producers:a,regions:r,provinces:i,cities:c,filter:g,getRegions:O,getProvinces:j,getCities:v,dialogVisible:l,openAllocationFormDialog:k,updateTable:h,dialogData:u,dialogFormData:d,submitAllocationForm:w,allocatedDataGrid:p,unallocatedDataGrid:b,user:m}}});const se=F()(de,[["render",w]]);var pe=se,be=(n("a15b"),n("d81d"),{class:"p-5"}),fe=Object(a["createVNode"])("p",null,"Periode Registrasi:",-1),me={class:"mb-4"},ge={class:"grid grid-cols-4 gap-4 mb-4"},Oe={key:0},je={class:"grid grid-cols-3 gap-4 mb-4"},ve=Object(a["createVNode"])("label",{for:"produsen"},"Produsen",-1),he={class:"text-base"},ke=Object(a["createVNode"])("label",{for:"propinsi"},"Propinsi",-1),we={class:"text-base"},De=Object(a["createVNode"])("label",{for:"kabupaten"},"Kabupaten",-1),xe={class:"text-base"},Ve={class:"grid grid-cols-1 gap-4 mb-4"},Ce=Object(a["createVNode"])("label",{for:"produsen"},"Daftar Produk",-1),_e={class:"text-base"},Ne=Object(a["createVNode"])("div",{class:"border border-b-0 mb-4"},null,-1),ye={class:"grid grid-cols-1 gap-4"},Ie=Object(a["createVNode"])("label",{for:"produsen"},"Total Tonase",-1),Pe={class:"dialog-footer"},Ae=Object(a["createTextVNode"])("Cancel"),Be=Object(a["createTextVNode"])("Confirm");function Re(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("el-option"),l=Object(a["resolveComponent"])("el-select"),u=Object(a["resolveComponent"])("form-item"),d=Object(a["resolveComponent"])("data-grid"),s=Object(a["resolveComponent"])("el-tab-pane"),p=Object(a["resolveComponent"])("import-allocation"),b=Object(a["resolveComponent"])("el-tabs"),f=Object(a["resolveComponent"])("el-button"),m=Object(a["resolveComponent"])("el-dialog"),g=Object(a["resolveComponent"])("document-form"),O=Object(a["resolveDirective"])("loading");return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createBlock"])(g,{title:"Rencana Alokasi Tonase"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("div",be,[fe,Object(a["createVNode"])("div",me,[Object(a["createVNode"])(l,{class:"form-control",modelValue:e.filter.periodId,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.filter.periodId=t})},{default:Object(a["withCtx"])((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.registrationPeriods,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{key:e.id,value:e.id,label:e.period},null,8,["value","label"])})),128))]})),_:1},8,["modelValue"])]),Object(a["createVNode"])("div",ge,[Object(a["createVNode"])(u,{label:"Produsen"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(l,{class:"form-control",modelValue:e.filter.producerId,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.filter.producerId=t}),onChange:e.getRegions},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{value:-1,label:"Semua Produsen"}),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.producers,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{label:e.name,value:e.producer_code,key:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1}),Object(a["createVNode"])(u,{label:"Region"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(l,{class:"form-control",modelValue:e.filter.regionId,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.filter.regionId=t}),disabled:null==e.filter.producerId,onChange:e.getProvinces},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{value:-1,label:"Semua Region"}),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.regions,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{label:e.name,value:e.code,key:e.name},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","disabled","onChange"])]})),_:1}),Object(a["createVNode"])(u,{label:"Propinsi"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(l,{class:"form-control",modelValue:e.filter.provinceId,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.filter.provinceId=t}),disabled:null==e.filter.regionId,onChange:e.updateTable},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{value:-1,label:"Semua Propinsi"}),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.provinces,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{label:e.provinces.province_name,value:e.province_id,key:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","disabled","onChange"])]})),_:1})]),Object(a["createVNode"])(b,{type:"border-card"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(s,{label:"Sudah Dialokasikan",class:"pb-10"},{default:Object(a["withCtx"])((function(){return[null!=e.filter.periodId?(Object(a["openBlock"])(),Object(a["createBlock"])(d,{key:0,ref:"allocatedDataGrid",allocated:1,registrationPeriodId:e.filter.periodId},null,8,["registrationPeriodId"])):Object(a["createCommentVNode"])("",!0)]})),_:1}),"svp_pso_admin"!=e.user.role.name?(Object(a["openBlock"])(),Object(a["createBlock"])(s,{key:0,label:"Belum Dialokasikan",class:"pb-10"},{default:Object(a["withCtx"])((function(){return[null!=e.filter.periodId?(Object(a["openBlock"])(),Object(a["createBlock"])(d,{key:0,ref:"unallocatedDataGrid",onOpenAllocationFormDialog:e.openAllocationFormDialog,allocated:0,registrationPeriodId:e.filter.periodId},null,8,["onOpenAllocationFormDialog","registrationPeriodId"])):Object(a["createCommentVNode"])("",!0)]})),_:1})):Object(a["createCommentVNode"])("",!0),"svp_pso_admin"!=e.user.role.name?(Object(a["openBlock"])(),Object(a["createBlock"])(s,{key:1,label:"Import Alokasi",class:"pb-10"},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(p)]})),_:1})):Object(a["createCommentVNode"])("",!0)]})),_:1})]),Object(a["createVNode"])(m,{"append-to-body":"",title:"Tetapkan alokasi tonase",modelValue:e.dialogVisible,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.dialogVisible=t}),width:"50%"},{footer:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("span",Pe,[Object(a["createVNode"])(f,{onClick:t[6]||(t[6]=function(t){return e.dialogVisible=!1})},{default:Object(a["withCtx"])((function(){return[Ae]})),_:1}),Object(a["createVNode"])(f,{type:"primary",onClick:e.submitAllocationForm},{default:Object(a["withCtx"])((function(){return[Be]})),_:1},8,["onClick"])])]})),default:Object(a["withCtx"])((function(){return[null!=e.dialogData?(Object(a["openBlock"])(),Object(a["createBlock"])("div",Oe,[Object(a["createVNode"])("div",je,[Object(a["createVNode"])("div",null,[ve,Object(a["createVNode"])("p",he,Object(a["toDisplayString"])(e.dialogData.producer.name),1)]),Object(a["createVNode"])("div",null,[ke,Object(a["createVNode"])("p",we,Object(a["toDisplayString"])(e.dialogData.province.province_name),1)]),Object(a["createVNode"])("div",null,[De,Object(a["createVNode"])("p",xe,Object(a["toDisplayString"])(e.dialogData.city.city_type)+" "+Object(a["toDisplayString"])(e.dialogData.city.city_name),1)])]),Object(a["createVNode"])("div",Ve,[Object(a["createVNode"])("div",null,[Ce,Object(a["createVNode"])("p",_e,Object(a["toDisplayString"])(e.dialogData.products.map((function(e){return e.product.name})).join(", ")),1)])]),Ne,Object(a["createVNode"])("div",ye,[Object(a["createVNode"])("div",null,[Ie,Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.dialogFormData.allocation=t}),class:"form-control mt-2"},null,512),[[a["vModelText"],e.dialogFormData.allocation]])])])])):Object(a["createCommentVNode"])("",!0)]})),_:1},8,["modelValue"])]})),_:1},512)),[[O,e.loading]])}var Se=Object(a["createVNode"])("h4",null,"Daftar Produk:",-1);function Fe(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("DxFilterRow"),l=Object(a["resolveComponent"])("DxColumn"),u=Object(a["resolveComponent"])("DxMasterDetail"),d=Object(a["resolveComponent"])("DxPaging"),s=Object(a["resolveComponent"])("DxPager"),p=Object(a["resolveComponent"])("DxDataGrid");return Object(a["openBlock"])(),Object(a["createBlock"])(p,{ref:"root","data-source":e.customStore,"show-borders":!0,"remote-operations":{paging:!0,filtering:!0,sorting:!1},selection:{mode:"single"},onSelectionChanged:e.onSelectionChanged,onToolbarPreparing:t[1]||(t[1]=function(t){return e.onToolbarPreparing(t)})},{propinsiCellTemplate:Object(a["withCtx"])((function(e){var t=e.data;return[Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(t.data.province.province_name),1)]})),kabupatenKotaCellTemplate:Object(a["withCtx"])((function(e){var t=e.data;return[Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(t.data.city.city_type)+" "+Object(a["toDisplayString"])(t.data.city.city_name),1)]})),produsenCellTemplate:Object(a["withCtx"])((function(e){var t=e.data;return[Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(t.data.producer.name),1)]})),cellTemplate:Object(a["withCtx"])((function(t){var n=t.data;return[0==e.allocated?(Object(a["openBlock"])(),Object(a["createBlock"])("button",{key:0,onClick:function(t){return e.openAllocationFormDialog(n.data)},class:"btn bg-theme-4 px-4 py-2 text-white text-xs"},"Input Alokasi",8,["onClick"])):Object(a["createCommentVNode"])("",!0)]})),productTable:Object(a["withCtx"])((function(e){var t=e.data;return[Object(a["createVNode"])("div",null,[Se,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(t.data.products.map((function(e){return e.product.name})).join(", ")),1)])]})),default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{visible:!0}),Object(a["createVNode"])(l,{"data-field":"province.province_name","data-type":"string",caption:"Propinsi","cell-template":"propinsiCellTemplate"}),Object(a["createVNode"])(l,{"data-field":"city.city_name","data-type":"string",caption:"Kabupaten\\Kota","cell-template":"kabupatenKotaCellTemplate"}),Object(a["createVNode"])(l,{"data-field":"producer.name","data-type":"string",caption:"Produsen","cell-template":"produsenCellTemplate"}),e.allocated?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0,allowFiltering:!1,"data-field":"total_tonnage_of_product","data-type":"string",caption:"Total Alokasi Tonase"})):Object(a["createCommentVNode"])("",!0),e.allocated?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:1,allowFiltering:!1,"data-field":"created_at","data-type":"string",caption:"Created At"})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(l,{"data-field":"id",caption:"Action","cell-template":"cellTemplate"}),Object(a["createVNode"])(u,{class:"bg-white",enabled:!0,template:"productTable",autoExpandAll:!1}),Object(a["createVNode"])(d,{"page-size":20}),Object(a["createVNode"])(s,{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20]})]})),_:1},8,["data-source","onSelectionChanged"])}var Te=Object(a["defineComponent"])({components:{DxDataGrid:N["DxDataGrid"],DxColumn:N["DxColumn"],DxPaging:N["DxPaging"],DxPager:N["DxPager"],DxSorting:N["DxSorting"],DxHeaderFilter:N["DxHeaderFilter"],DxFilterRow:N["DxFilterRow"],DxMasterDetail:N["DxMasterDetail"]},props:["registrationPeriodId","allocated"],setup:function(e,t){var n=this,r=t.emit,o=Object(B["b"])(),i=Object(a["ref"])(null);Object(a["onMounted"])((function(){}));function c(e){return void 0!==e&&null!==e&&""!==e}var l=Object(a["inject"])("env"),u=new I.a({key:"city_id",load:function(t){var n="?";return["skip","take","requireTotalCount","requireGroupCount","sort","filter","totalSummary","group","groupSummary"].forEach((function(e){e in t&&c(t[e])&&(n+="".concat(e,"=").concat(JSON.stringify(t[e]),"&"))})),n=n.slice(0,-1),n+="&registration_period=".concat(e.registrationPeriodId),n+="&allocated=".concat(e.allocated),P["a"].get("".concat(l["VUE_APP_API_ENDPOINT"],"/tonnage-allocations").concat(n)).then((function(e){return e.data})).catch((function(){throw"Data Loading Error"}))}}),d=function(e){e.selectedRowsData},s=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A["a"].activate(t).then((function(e){x.a.success({title:"Success",position:"bottom-right"}),b()})).catch((function(e){x.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A["a"].deactivate(t).then((function(e){x.a.success({title:"Success",position:"bottom-right"}),b()})).catch((function(e){x.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){i.value.instance.refresh()},f=function(){i.value.instance.clearSelection()},m=function(e){e.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"refresh",onClick:b.bind(n)}})},g=o.state.auth.user,O=function(t){return["svp_region","svp_pso_planning_management","sevp_marketing_ops","marketing_director"].includes(g.role.name)?{name:"admin-document-verification.distributor-profile.document-verification",params:{distributor_id:t.data.distributor_id},query:{registration_period:e.registrationPeriodId}}:{name:"admin-document-verification.bundle",params:{distributor_id:t.data.distributor_id},query:{registration_period:e.registrationPeriodId}}},j=function(e){r("openAllocationFormDialog",e)};return{customStore:u,onSelectionChanged:d,activate:s,deactivate:p,onToolbarPreparing:m,refreshDataGrid:b,clearSelection:f,root:i,linkToProcessDocument:O,openAllocationFormDialog:j}}});const Ee=F()(Te,[["render",Fe]]);var Ge=Ee,Ue={class:"p-5"},Me={class:"mt-3"},Ke={class:"sm:grid grid-cols-2 gap-5"},Le={class:"mb-4"},$e=Object(a["createTextVNode"])("Click to upload"),qe={class:"flex w-full px-5"},ze={class:"ml-auto"};function He(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("el-option"),l=Object(a["resolveComponent"])("el-select"),u=Object(a["resolveComponent"])("form-item"),d=Object(a["resolveComponent"])("el-button"),s=Object(a["resolveComponent"])("el-upload"),p=Object(a["resolveDirective"])("loading");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])("div",Ue,[Object(a["createVNode"])("div",Me,[Object(a["createVNode"])("div",Ke,[Object(a["createVNode"])(u,{label:"Periode Alokasi",validationData:e.validate.periodId},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])("div",Le,[Object(a["withDirectives"])(Object(a["createVNode"])(l,{class:"form-control",modelValue:e.formData.periodId,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.formData.periodId=t})},{default:Object(a["withCtx"])((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.registrationPeriods,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{key:e.id,value:e.id,label:e.period},null,8,["value","label"])})),128))]})),_:1},8,["modelValue"]),[[p,e.loadingPeriod]])])]})),_:1},8,["validationData"]),Object(a["createVNode"])(u,{label:"File Alokasi Tonase",validationData:e.validate.file_path},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(s,{ref:"elUpload",class:"upload-demo",action:e.env["VUE_APP_API_ENDPOINT"]+"/files",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},"with-credentials":!0,"on-success":e.onUploadSuccees,"file-list":null!=e.formData.file_path?[{name:"file-import-alokasi",url:e.formData.file_path}]:[],"on-preview":e.handlePreview},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(d,{size:"small",type:"primary"},{default:Object(a["withCtx"])((function(){return[$e]})),_:1})]})),_:1},8,["action","on-success","file-list","on-preview"])]})),_:1},8,["validationData"])])])]),Object(a["createVNode"])("div",qe,[Object(a["createVNode"])("div",ze,[Object(a["withDirectives"])(Object(a["createVNode"])("button",{type:"button",class:"btn btn-primary w-24 mr-2",onClick:t[2]||(t[2]=function(){return e.add&&e.add.apply(e,arguments)})}," Add ",512),[[p,e.loading]])])])],64)}var Xe={periodId:null,file_path:null},Je=Object(a["defineComponent"])({components:{DocumentForm:i["a"],FormItem:C["a"]},setup:function(){var e,t=Object(Q["d"])(),n=(t.state.auth.user,Object(a["ref"])(!1)),r=Object(a["ref"])(!1),o=Object(ae["a"])(),i=Object(a["ref"])(null),c=Object(a["inject"])("env"),l=Object(a["ref"])([]),u=Object(a["reactive"])(Object(X["a"])({},Xe)),d={periodId:{required:Y["c"]},file_path:{required:Y["c"]}},s=Object(W["a"])(d,Object(a["toRefs"])(u));Object(a["onMounted"])(Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.value=!0,r.value=!0,e.next=4,Z["a"].getAll().then((function(e){if(l.value=e.data.data,l.value.length){var t=l.value.find((function(e){return e.active}));t&&(u.periodId=t.id)}})).finally((function(){n.value=!1,r.value=!1}));case 4:case"end":return e.stop()}}),e)}))));var p=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s.value.$touch(),s.value.$invalid?x.a.error({title:"Submit Gagal",message:"Silahkan periksa form sekali lagi",position:"bottom-right"}):o.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.value=!0,e.next=3,ne.read_tonnage(u).then((function(e){x.a.success({title:"Data berhasil disimpan",position:"bottom-right"})})).catch((function(e){x.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})})).finally((function(){n.value=!1}));case 3:case"end":return e.stop()}}),e)})))).catch((function(){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e,t,n){u.file_path=e.id},f=function(e){var t=window.open(c["VUE_APP_API_ENDPOINT"]+"/files?filePath="+e.url,"_blank");t.focus()};return e={env:c,formData:u,validate:s,loading:n,loadingPeriod:r,add:p},Object(H["a"])(e,"add",p),Object(H["a"])(e,"onUploadSuccees",b),Object(H["a"])(e,"elUpload",i),Object(H["a"])(e,"handlePreview",f),Object(H["a"])(e,"registrationPeriods",l),e}});const We=F()(Je,[["render",He]]);var Ye=We,Qe=n("30dd"),Ze=Object(o["c"])({components:{DocumentForm:i["a"],DataGrid:Ge,FormItem:C["a"],importAllocation:Ye},setup:function(){var e=Object(o["p"])(!1),t=Object(o["o"])({id:null,period:null}),n=Object(o["p"])([]),a=Object(o["p"])([]),r=Object(o["p"])([]),i=Object(o["p"])([]),c=Object(o["p"])([]),l=Object(o["p"])(!1),u=Object(o["p"])(null),d=Object(o["o"])({allocation:0}),s=Object(ae["a"])(),p=Object(o["p"])(null),b=Object(o["p"])(null),f=Object(Q["d"])(),m=f.state.auth.user,g=Object(o["o"])({periodId:-1,producerId:-1,regionId:-1,provinceId:-1,cityId:-1});Object(o["m"])(Object(V["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.value=!0,t.next=3,Z["a"].getAll().then((function(e){if(n.value=e.data.data,n.value.length){var t=n.value.find((function(e){return e.active}));t&&(g.periodId=t.id)}}));case 3:return t.next=5,ce["a"].getProducers().then((function(e){a.value=e.data}));case 5:e.value=!1;case 6:case"end":return t.stop()}}),t)}))));var O=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==g.producerId){e.next=4;break}return e.next=3,le["a"].regions(g.producerId).then((function(e){r.value=e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==g.regionId){e.next=4;break}return e.next=3,le["a"].regionProvinces(g.regionId).then((function(e){i.value=e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==g.provinceId){e.next=4;break}return e.next=3,le["a"].regionProducerArea(g.provinceId).then((function(e){c.value=e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",g);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(e){l.value=!0,u.value=e},w=function(){var e=Object(V["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(V["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=u.value,n=t.producer_code,a=t.province_id,r=t.city_id,e.next=3,Qe["a"].setAllocation({registration_period_id:g.periodId,producer_code:n,province_id:a,city_id:r,total_tonnage:Number(d.allocation)}).then((function(e){b.value.refreshDataGrid(),p.value.refreshDataGrid(),x.a.success({title:"Data berhasil disimpan",position:"bottom-right"})})).catch((function(e){x.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})}));case 3:d.allocation=0,u.value=null,l.value=!1;case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{registrationPeriod:t,registrationPeriods:n,loading:e,producers:a,regions:r,provinces:i,cities:c,filter:g,getRegions:O,getProvinces:j,getCities:v,dialogVisible:l,openAllocationFormDialog:k,updateTable:h,dialogData:u,dialogFormData:d,submitAllocationForm:w,allocatedDataGrid:p,unallocatedDataGrid:b,user:m}}});const et=F()(Ze,[["render",Re]]);var tt=et,nt=Object(o["c"])({components:{DocumentForm:i["a"],distributorAllocation:pe,tonnageAllocation:tt},setup:function(){}});const at=F()(nt,[["render",r]]);t["default"]=at}}]);