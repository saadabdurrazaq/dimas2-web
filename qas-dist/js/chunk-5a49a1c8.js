(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a49a1c8"],{2388:function(e,t,n){"use strict";var o=n("c953"),r="/company-management",a=function(){return o["a"].get(r)},c=function(e){return o["a"].post(r,e)},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return o["a"].put(r+"/".concat(e),t)},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return o["a"].put(r+"/".concat(e,"/activate"),t)},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return o["a"].put(r+"/".concat(e,"/deactivate"),t)};t["a"]={get:a,add:c,update:i,activate:l,deactivate:u}},2611:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("8afd");function r(){return{$show:Object(o["e"])("$messageBox"),$prompt:Object(o["e"])("$prompt"),$alert:Object(o["e"])("$alert"),$confirm:Object(o["e"])("$confirm")}}},"30dd":function(e,t,n){"use strict";var o=n("c953"),r=function(e){return o["a"].post("/tonnage-allocations",e)},a=function(e){return o["a"].get("/get-allocation/tonnage".concat(e))};t["a"]={setAllocation:r,getAllocation:a}},"56dd":function(e,t,n){"use strict";var o=n("5530"),r=n("c953"),a=function(e){return r["a"].post("/registration-periods",Object(o["a"])({},e))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return r["a"].put("registration-periods/".concat(e),{data:t})},i=function(){return r["a"].get("/registration-periods/get-active")},l=function(){return r["a"].get("/registration-periods")},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r["a"].put("registration-periods/".concat(e,"/activate"))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r["a"].put("registration-periods/".concat(e,"/deactivate"))},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r["a"].get("registration-periods/get-period/".concat(e))};t["a"]={create:a,update:c,getActive:i,getAll:l,activate:u,deactivate:d,searchPeriodId:s}},"8cbe":function(e,t,n){"use strict";var o=n("c953"),r=function(){return o["a"].get("/regions")},a=function(){return o["a"].get("/producer")};t["a"]={getRegions:r,getProducers:a}},bf72:function(e,t,n){"use strict";n.r(t);n("4de4"),n("b0c0"),n("99af");var o=n("7a23"),r={class:"p-5"},a=Object(o["createVNode"])("p",null,"Periode Registrasi:",-1),c={class:"mb-4"},i={class:"grid grid-cols-3 gap-4 mb-4"},l={class:"grid grid-cols-2 gap-4 mb-4"},u={style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, .24), 0 0 6px rgba(0, 0, 0, .08)",padding:"10px"}},d={style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, .24), 0 0 6px rgba(0, 0, 0, .08)",padding:"10px"}};function s(e,t,n,s,p,b){var m=Object(o["resolveComponent"])("el-option"),g=Object(o["resolveComponent"])("el-select"),f=Object(o["resolveComponent"])("form-item"),O=Object(o["resolveComponent"])("data-grid"),j=Object(o["resolveComponent"])("el-tab-pane"),v=Object(o["resolveComponent"])("el-tabs"),h=Object(o["resolveComponent"])("distributor-recommendation-dialog"),k=Object(o["resolveComponent"])("document-form"),x=Object(o["resolveDirective"])("loading");return Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createBlock"])(k,{title:"Rekomendasi Distributor"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("div",r,[a,Object(o["createVNode"])("div",c,[Object(o["createVNode"])(g,{class:"form-control",modelValue:e.filter.periodId,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.filter.periodId=t}),onChange:e.getAllocation},{default:Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.registrationPeriods,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(m,{key:e.id,value:e.id,label:e.period},null,8,["value","label"])})),128))]})),_:1},8,["modelValue","onChange"])]),Object(o["createVNode"])("div",i,[Object(o["createVNode"])(f,{label:"Region"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(g,{class:"form-control",modelValue:e.filter.regionCode,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.filter.regionCode=t}),disabled:null==e.filter.producerCode||-1==e.filter.producerCode,onChange:e.getProvinces},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(m,{value:-1,label:"Semua Region"}),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.regions,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(m,{label:e.name,value:e.code,key:e.name},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","disabled","onChange"])]})),_:1}),Object(o["createVNode"])(f,{label:"Propinsi"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(g,{class:"form-control",modelValue:e.filter.provinceId,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.filter.provinceId=t}),onChange:e.getCities},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(m,{value:-1,label:"Semua Propinsi"}),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.provinces,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(m,{label:e.provinces.province_name,value:e.province_id,key:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1}),Object(o["createVNode"])(f,{label:"Kab/Kota"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(g,{class:"form-control",modelValue:e.filter.cityId,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.filter.cityId=t}),onChange:e.refreshDataGrid},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(m,{value:-1,label:"Semua Kab/Kota"}),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.cities,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(m,{label:"".concat(e.cities.city_type," ").concat(e.cities.city_name),value:e.city_id,key:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1})]),Object(o["createVNode"])("div",l,[Object(o["withDirectives"])(Object(o["createVNode"])("div",u,[Object(o["createVNode"])("b",null,"Total Alokasi Distributor : "+Object(o["toDisplayString"])(e.allocationData.distributorAllocation),1)],512),[[x,e.distributorAllocationLoading]]),Object(o["withDirectives"])(Object(o["createVNode"])("div",d,[Object(o["createVNode"])("b",null,"Total Alokasi Tonase : "+Object(o["toDisplayString"])(e.allocationData.tonnageAllocation),1)],512),[[x,e.tonnageAllocationLoading]])]),Object(o["createVNode"])(v,{type:"border-card"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(j,{label:"Belum Diproses",class:"pb-10"},{default:Object(o["withCtx"])((function(){return[e.filterFulfilled?(Object(o["openBlock"])(),Object(o["createBlock"])(O,{key:0,ref:"unallocatedDataGrid",onOpenAllocationFormDialog:e.openAllocationFormDialog,allocated:0,registrationPeriodId:e.filter.periodId,filter:e.filter},null,8,["onOpenAllocationFormDialog","registrationPeriodId","filter"])):Object(o["createCommentVNode"])("",!0)]})),_:1}),Object(o["createVNode"])(j,{label:"Sudah Diproses",class:"pb-10"},{default:Object(o["withCtx"])((function(){return[e.filterFulfilled?(Object(o["openBlock"])(),Object(o["createBlock"])(O,{key:0,ref:"allocatedDataGrid",allocated:1,registrationPeriodId:e.filter.periodId,filter:e.filter},null,8,["registrationPeriodId","filter"])):Object(o["createCommentVNode"])("",!0)]})),_:1})]})),_:1})]),Object(o["createVNode"])(h,{dialogVisible:e.dialogVisible,"onUpdate:dialogVisible":[t[5]||(t[5]=function(t){return e.dialogVisible=t}),t[6]||(t[6]=function(t){return e.dialogVisible=t})],"onDialog:closed":e.refreshDataGrid,dialogData:e.dialogData,filter:e.filter},null,8,["dialogVisible","onDialog:closed","dialogData","filter"])]})),_:1},512)),[[x,e.loading]])}n("0cfa");var p=n("5040"),b=n.n(p),m=n("1da1"),g=(n("96cf"),n("7db0"),n("d3b7"),n("8afd")),f=n("c45b"),O=n("2022"),j={class:"grid grid-cols-1"},v=Object(o["createTextVNode"])(" Lihat Dokumen "),h={key:0},k={key:0},x={key:0,class:"grid grid-cols-2 gap-2"},y={key:1,style:{width:"300px"}},w=Object(o["createVNode"])("h4",{class:"font-semibold"},"Komponen Scoring",-1),_={class:"flex gap-4 bg-white p-4"},C=Object(o["createVNode"])("h4",null,"Total Alokasi Modal",-1),V=Object(o["createVNode"])("h4",null,"Total Kapasitas Gudang",-1),D=Object(o["createVNode"])("h4",null,"Total Luas Gudang",-1),N=Object(o["createVNode"])("h4",null,"Total Kapasitas Transportasi",-1),R={key:0},B=Object(o["createVNode"])("br",null,null,-1),S=Object(o["createVNode"])("h4",{class:"font-bold"},"Catatan Rekomendasi (SVP Perencanaan & Manajemen PSO):",-1),P=Object(o["createVNode"])("br",null,null,-1),A={key:0},I=Object(o["createVNode"])("h4",{class:"font-bold"},"Catatan Approval (SEVP Operasi Pemasaran):",-1),T={key:0,class:"flex"};function F(e,t,n,r,a,c){var i=Object(o["resolveComponent"])("DxFilterRow"),l=Object(o["resolveComponent"])("DxColumn"),u=Object(o["resolveComponent"])("router-link"),d=Object(o["resolveComponent"])("CheckIcon"),s=Object(o["resolveComponent"])("XIcon"),p=Object(o["resolveComponent"])("DxMasterDetail"),b=Object(o["resolveComponent"])("DxSelection"),m=Object(o["resolveComponent"])("DxPaging"),g=Object(o["resolveComponent"])("DxPager"),f=Object(o["resolveComponent"])("DxDataGrid"),O=Object(o["resolveDirective"])("loading");return Object(o["openBlock"])(),Object(o["createBlock"])(f,{ref:"root","data-source":e.customStore,"show-borders":!0,"remote-operations":{paging:!0,filtering:!0,sorting:!1},selection:{mode:"single"},"allow-column-reordering":!0,"allow-column-resizing":!0,"column-auto-width":!0,onSelectionChanged:e.onSelectionChanged,onToolbarPreparing:t[4]||(t[4]=function(t){return e.onToolbarPreparing(t)})},{distributorNameCellTemplate:Object(o["withCtx"])((function(t){var n=t.data;return[Object(o["createVNode"])("div",j,[Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(n.data.distributor.name),1),Object(o["createVNode"])(u,{to:e.linkToProcessDocument(n),target:"_blank",class:"text-xs underline text-blue-500 hover:text-blue-900 cursor-pointer"},{default:Object(o["withCtx"])((function(){return[v]})),_:2},1032,["to"])])]})),recomendationStatusCellTemplate:Object(o["withCtx"])((function(e){var t=e.data;return[Object(o["createVNode"])("div",null,[null===t.data.recommendation_status.is_recommended?(Object(o["openBlock"])(),Object(o["createBlock"])("span",h,"Belum Diproses")):Object(o["createCommentVNode"])("",!0),!0===t.data.recommendation_status.is_recommended?(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:1,class:"text-theme-9"})):Object(o["createCommentVNode"])("",!0),!1===t.data.recommendation_status.is_recommended?(Object(o["openBlock"])(),Object(o["createBlock"])(s,{key:2,class:"text-theme-6"})):Object(o["createCommentVNode"])("",!0)])]})),approvalStatusCellTemplate:Object(o["withCtx"])((function(e){var t=e.data;return[Object(o["createVNode"])("div",null,[null===t.data.recommendation_status.is_approved?(Object(o["openBlock"])(),Object(o["createBlock"])("span",k,"Belum Diproses")):Object(o["createCommentVNode"])("",!0),!0===t.data.recommendation_status.is_approved?(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:1,class:"text-theme-9"})):Object(o["createCommentVNode"])("",!0),!1===t.data.recommendation_status.is_approved?(Object(o["openBlock"])(),Object(o["createBlock"])(s,{key:2,class:"text-theme-6"})):Object(o["createCommentVNode"])("",!0)])]})),cellTemplate:Object(o["withCtx"])((function(t){var n=t.data;return[0==e.allocated?(Object(o["openBlock"])(),Object(o["createBlock"])("div",x,[Object(o["withDirectives"])(Object(o["createVNode"])("button",{onClick:function(t){return e.openAllocationFormDialog(n.data,!0)},class:"btn bg-theme-9 px-4 py-2 text-white text-xs"}," Recommend ",8,["onClick"]),[[O,e.get_allocation_loading]]),Object(o["createVNode"])("button",{onClick:function(t){return e.openAllocationFormDialog(n.data)},class:"btn bg-theme-6 px-4 py-2 text-white text-xs"}," Not Recommend ",8,["onClick"])])):(Object(o["openBlock"])(),Object(o["createBlock"])("div",y))]})),productTable:Object(o["withCtx"])((function(t){var n=t.data;return[Object(o["createVNode"])("div",null,[w,Object(o["createVNode"])("section",_,[Object(o["createVNode"])("div",null,[C,Object(o["createVNode"])("p",null,Object(o["toDisplayString"])(e.currencyFormatter.format(n.data.scoring_component.total_alokasi)),1)]),Object(o["createVNode"])("div",null,[V,Object(o["createVNode"])("p",null,Object(o["toDisplayString"])(n.data.scoring_component.total_kapasitas_gudang)+" Ton",1)]),Object(o["createVNode"])("div",null,[D,Object(o["createVNode"])("p",null,Object(o["toDisplayString"])(n.data.scoring_component.total_luas_gudang)+" M2",1)]),Object(o["createVNode"])("div",null,[N,Object(o["createVNode"])("p",null,Object(o["toDisplayString"])(n.data.scoring_component.total_kapasitas_transportasi)+" Ton",1)])]),e.allocated?(Object(o["openBlock"])(),Object(o["createBlock"])("section",R,[B,Object(o["createVNode"])("div",null,[S,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(n.data.recommendation_status.recommendation_notes?n.data.recommendation_status.recommendation_notes:"-"),1)]),P,null!=n.data.recommendation_status.is_approved?(Object(o["openBlock"])(),Object(o["createBlock"])("div",A,[I,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(n.data.recommendation_status.approval_notes?n.data.recommendation_status.approval_notes:"-"),1)])):Object(o["createCommentVNode"])("",!0)])):Object(o["createCommentVNode"])("",!0)])]})),toolbarTemplate:Object(o["withCtx"])((function(){return[e.selectedRowKeyArray.length?(Object(o["openBlock"])(),Object(o["createBlock"])("div",T,[Object(o["createVNode"])("button",{class:"px-4 py-2 btn bg-theme-9 text-white rounded mr-2",onClick:t[1]||(t[1]=function(){return e.approveSelected&&e.approveSelected.apply(e,arguments)})}," Recommend Selected "),Object(o["createVNode"])("button",{class:"px-4 py-2 btn bg-theme-6 text-white rounded mr-2",onClick:t[2]||(t[2]=function(){return e.rejectSelected&&e.rejectSelected.apply(e,arguments)})}," Not Recommend Selected "),Object(o["createVNode"])("button",{class:"px-4 py-2 btn rounded",onClick:t[3]||(t[3]=function(t){return e.root.instance.clearSelection()})}," Clear Selection ")])):Object(o["createCommentVNode"])("",!0)]})),default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(i,{visible:!0}),Object(o["createVNode"])(l,{"data-field":"distributor.sap_id","data-type":"string",caption:"Customer ID"}),Object(o["createVNode"])(l,{width:300,"data-field":"distributor.name","data-type":"string",caption:"Distributor","cell-template":"distributorNameCellTemplate"}),e.allocated?(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:0,allowFiltering:!1,"data-field":"status.is_recommended","data-type":"boolean",caption:"Rekomendasi dari SVP Perencanaan & Manajemen PSO","cell-template":"recomendationStatusCellTemplate"})):Object(o["createCommentVNode"])("",!0),e.allocated?(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:1,allowFiltering:!1,"data-field":"status.is_approved","data-type":"boolean",caption:"Approval dari SEVP Operasi Pemasaran","cell-template":"approvalStatusCellTemplate"})):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(l,{"data-field":"region_name","data-type":"string",caption:"Region"}),Object(o["createVNode"])(l,{"data-field":"province_name","data-type":"string",caption:"Propinsi"}),Object(o["createVNode"])(l,{"data-field":"city_name","data-type":"string",caption:"Kabupaten\\Kota"}),"svp_pso_admin"==e.user.role.name||e.is_allocated?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:2,allowFiltering:!1,width:300,"data-field":"distributor_region_id",caption:"Action","cell-template":"cellTemplate"})),Object(o["createVNode"])(p,{class:"bg-white",enabled:!0,template:"productTable",autoExpandAll:!0}),e.is_allocated?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:3,mode:"multiple","select-all-mode":"page"})),Object(o["createVNode"])(m,{"page-size":10}),Object(o["createVNode"])(g,{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,15]})]})),_:1},8,["data-source","onSelectionChanged"])}n("fb6a"),n("159b"),n("caad");var K=n("d30a"),G=n("2597"),M=n.n(G),L=n("c953"),$=n("2388"),E=n("eeae"),U=n("dd4e"),q=n("2611"),J=n("4360"),z=Object(o["defineComponent"])({components:{DxDataGrid:K["DxDataGrid"],DxColumn:K["DxColumn"],DxPaging:K["DxPaging"],DxPager:K["DxPager"],DxSorting:K["DxSorting"],DxHeaderFilter:K["DxHeaderFilter"],DxFilterRow:K["DxFilterRow"],DxMasterDetail:K["DxMasterDetail"],DxSelection:K["DxSelection"]},props:["registrationPeriodId","allocated","filter"],setup:function(e,t){var n=this,r=t.emit,a=Object(J["b"])(),c=a.state.auth.user,i=Object(o["ref"])(null),l=(Object(o["onMounted"])((function(){})),Object(q["a"])());function u(e){return void 0!==e&&null!==e&&""!==e}var d=Object(o["inject"])("env"),s=0!=e.allocated,p=new M.a({key:"distributor_region_id",load:function(t){var n="?";return["skip","take","requireTotalCount","requireGroupCount","sort","filter","totalSummary","group","groupSummary"].forEach((function(e){e in t&&u(t[e])&&(n+="".concat(e,"=").concat(JSON.stringify(t[e]),"&"))})),n=n.slice(0,-1),n+="&registration_period=".concat(e.registrationPeriodId),n+="&region_code=".concat(e.filter.regionCode),n+="&producer_code=".concat(e.filter.producerCode),n+="&province_id=".concat(e.filter.provinceId),n+="&city_id=".concat(e.filter.cityId),n+="&allocated=".concat(e.allocated),L["a"].get("".concat(d["VUE_APP_API_ENDPOINT"],"/distributor-recommendations").concat(n)).then((function(e){return e.data})).catch((function(){throw"Data Loading Error"}))}}),g=Object(o["ref"])([]),f=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.currentSelectedRowKeys.forEach((function(e){t.component.byKey(e).done((function(n){n.related_bundles_on_revision_hold?(t.component.deselectRows(e),b.a.warning({title:"Failed",message:"Related bundle on revision process",position:"bottom-right"})):t.component.selectRows(e,!0)}))})),e.next=3,i.value.instance.getSelectedRowsData();case 3:g.value=e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(o["computed"])(Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.value.instance.getSelectedRowKeys();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));function O(){return j.apply(this,arguments)}function j(){return j=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:l.$prompt("Anda yakin ingin merekomendasikan data yang sudah dipilih untuk diterima. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",inputPlaceholder:"Catatan rekomendasi penerimaan",closeOnClickModal:!1}).then(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.value,e.next=3,U["a"].setMultipleRecommendation({data:g.value,notes:n,is_recommended:!0}).then((function(e){b.a.success({title:"Success",position:"bottom-right"}),y(),w()})).catch((function(e){b.a.error({title:"Failed",position:"bottom-right"})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}function v(){return h.apply(this,arguments)}function h(){return h=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:l.$prompt("Anda yakin ingin merekomendasikan data yang sudah dipilih untuk ditolak. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",inputPlaceholder:"Catatan rekomendasi penolakan",closeOnClickModal:!1}).then(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.value,e.next=3,U["a"].setMultipleRecommendation({data:g.value,notes:n,is_recommended:!1}).then((function(e){b.a.success({title:"Success",position:"bottom-right"}),y(),w()})).catch((function(e){b.a.error({title:"Failed",position:"bottom-right"})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}var k=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$["a"].activate(t).then((function(e){b.a.success({title:"Success",position:"bottom-right"}),y()})).catch((function(e){b.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$["a"].deactivate(t).then((function(e){b.a.success({title:"Success",position:"bottom-right"}),y()})).catch((function(e){b.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){i.value.instance.refresh()},w=function(){i.value.instance.clearSelection()},_=function(e){e.toolbarOptions.items.unshift({location:"before",template:"toolbarTemplate"},{location:"after",widget:"dxButton",options:{icon:"refresh",onClick:y.bind(n)}})},C=function(t){return["svp_region","svp_pso_planning_management","sevp_marketing_ops","marketing_director"].includes(c.role.name)?{name:"admin-document-verification.distributor-profile.document-verification",params:{distributor_id:t.data.distributor.id},query:{registration_period:e.registrationPeriodId}}:{name:"admin-document-verification.bundle",params:{distributor_id:t.data.distributor.id},query:{registration_period:e.registrationPeriodId}}},V=Object(o["ref"])(!1),D=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return V.value=!0,e.next=3,E["a"].isAllocationFull(t,"recommendation").then((function(e){e.data.status_full?l.$confirm("Jumlah rekomendasi distributor di kabupaten ini telah terpenuhi. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:R(t,n);case 1:case"end":return e.stop()}}),e)})))).catch((function(){})):R(t,n)})).catch((function(e){})).finally((function(){V.value=!1}));case 3:case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?D(e,t):R(e,t)},R=function(e,t){e.recommended=t,r("openAllocationFormDialog",e)},B=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"});return{get_allocation_loading:V,customStore:p,onSelectionChanged:f,activate:k,deactivate:x,onToolbarPreparing:_,refreshDataGrid:y,clearSelection:w,root:i,linkToProcessDocument:C,openAllocationFormDialog:N,currencyFormatter:B,user:c,approveSelected:O,rejectSelected:v,is_allocated:s,selectedRowKeyArray:g}}}),H=n("6b0d"),X=n.n(H);const Q=X()(z,[["render",F]]);var W=Q,Y=n("56dd"),Z=n("8cbe"),ee=n("fb27"),te=n("30dd"),ne={key:0},oe={class:"grid grid-cols-3 gap-4 mb-2"},re=Object(o["createVNode"])("label",{for:"produsen"},"Distributor",-1),ae={class:"text-base"},ce=Object(o["createVNode"])("label",{for:"produsen"},"Status",-1),ie={key:0,class:"text-base text-theme-9"},le={key:1,class:"text-base text-theme-6"},ue={class:"grid grid-cols-3 gap-4 mb-4"},de=Object(o["createVNode"])("label",{for:"propinsi"},"Di Propinsi",-1),se={class:"text-base"},pe=Object(o["createVNode"])("label",{for:"kabupaten"},"Di Kabupaten",-1),be={class:"text-base"},me=Object(o["createVNode"])("div",{class:"border border-b-0 mb-4"},null,-1),ge={class:"grid grid-cols-1 gap-4"},fe=Object(o["createVNode"])("label",{for:"produsen"},"Notes",-1),Oe={class:"dialog-footer"},je=Object(o["createTextVNode"])("Cancel"),ve=Object(o["createTextVNode"])("Confirm");function he(e,t,n,r,a,c){var i=Object(o["resolveComponent"])("el-button"),l=Object(o["resolveComponent"])("el-dialog");return Object(o["openBlock"])(),Object(o["createBlock"])(l,{"append-to-body":"",title:"Tetapkan Status Rekomendasi Distributor",modelValue:e.dialogVisible,width:"50%",onClose:e.closeDialog},{footer:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("span",Oe,[Object(o["createVNode"])(i,{onClick:e.closeDialog},{default:Object(o["withCtx"])((function(){return[je]})),_:1},8,["onClick"]),Object(o["createVNode"])(i,{type:"primary",onClick:e.submitAllocationForm},{default:Object(o["withCtx"])((function(){return[ve]})),_:1},8,["onClick"])])]})),default:Object(o["withCtx"])((function(){return[null!=e.dialogData?(Object(o["openBlock"])(),Object(o["createBlock"])("div",ne,[Object(o["createVNode"])("div",oe,[Object(o["createVNode"])("div",null,[re,Object(o["createVNode"])("p",ae,Object(o["toDisplayString"])(e.dialogData.distributor.business_entity_type)+" "+Object(o["toDisplayString"])(e.dialogData.distributor.name),1)]),Object(o["createVNode"])("div",null,[ce,e.dialogData.recommended?(Object(o["openBlock"])(),Object(o["createBlock"])("p",ie,"APPROVED")):(Object(o["openBlock"])(),Object(o["createBlock"])("p",le,"REJECTED"))])]),Object(o["createVNode"])("div",ue,[Object(o["createVNode"])("div",null,[de,Object(o["createVNode"])("p",se,Object(o["toDisplayString"])(e.dialogData.province.province_name),1)]),Object(o["createVNode"])("div",null,[pe,Object(o["createVNode"])("p",be,Object(o["toDisplayString"])(e.dialogData.city.city_type)+" "+Object(o["toDisplayString"])(e.dialogData.city.city_name),1)])]),me,Object(o["createVNode"])("div",ge,[Object(o["createVNode"])("div",null,[fe,Object(o["withDirectives"])(Object(o["createVNode"])("textarea",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.dialogFormData.notes=t}),class:"form-control mt-2"},null,512),[[o["vModelText"],e.dialogFormData.notes]])])])])):Object(o["createCommentVNode"])("",!0)]})),_:1},8,["modelValue","onClose"])}var ke=Object(g["c"])({props:{value:String,dialogVisible:{type:Boolean},dialogData:{required:!0},filter:{required:!0}},emits:["update:dialogVisible","dialog:closed"],setup:function(e,t){var n=t.emit,o=Object(g["o"])({notes:""}),r=Object(q["a"])(),a=function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,U["a"].setRecommendation({registration_period_id:e.filter.periodId,distributor_id:e.dialogData.distributor_id,region_code:e.filter.regionCode,province_id:e.filter.provinceId,city_id:e.filter.cityId,producer_code:e.filter.producerCode,recommendation_notes:o.notes,is_recommended:e.dialogData.recommended,distributor_regions_id:e.dialogData.distributor_region_id}).then((function(e){b.a.success({title:"Success",position:"bottom-right"})})).catch((function(e){b.a.error({title:"Failed",position:"bottom-right"})}));case 2:c(),n("dialog:closed");case 4:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=function(){o.notes="",n("update:dialogVisible",!1)};return{dialogFormData:o,submitAllocationForm:a,closeDialog:c}}});const xe=X()(ke,[["render",he]]);var ye=xe,we=Object(g["c"])({components:{DocumentForm:f["a"],DataGrid:W,FormItem:O["a"],DistributorRecommendationDialog:ye},setup:function(){var e=Object(g["p"])(!1),t=Object(g["p"])(!1),n=Object(g["p"])(!1),o=Object(g["o"])({id:null,period:null}),r=Object(g["p"])([]),a=Object(g["p"])([]),c=Object(g["p"])([]),i=Object(g["p"])([]),l=Object(g["p"])([]),u=Object(g["p"])(!1),d=Object(g["p"])(null),s=Object(g["o"])({notes:""}),p=Object(q["a"])(),f=Object(g["p"])(null),O=Object(g["p"])(null),j=Object(g["o"])({tonnageAllocation:1e3,distributorAllocation:150}),v=Object(g["o"])({periodId:null,producerCode:null,regionCode:-1,provinceId:-1,cityId:-1});Object(g["m"])(Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.value=!0,t.next=3,Y["a"].getAll().then((function(e){if(r.value=e.data.data,r.value.length){var t=r.value.find((function(e){return e.active}));t&&(v.periodId=t.id)}}));case 3:return t.next=5,Z["a"].getProducers().then(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.value=t.data,v.producerCode=t.data[0].producer_code,e.next=4,k();case 4:v.regionCode=-1,v.provinceId=-1,v.cityId=-1;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:h(),e.value=!1;case 7:case"end":return t.stop()}}),t)}))));var h=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o="?",o+="registration_period=".concat(v.periodId),o+="&region_code=".concat(v.regionCode),o+="&province_id=".concat(v.provinceId),o+="&city_id=".concat(v.cityId),t.value=!0,n.value=!0,e.next=9,E["a"].getAllocation(o).then(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:j.distributorAllocation=t.data;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t.value=!1}));case 9:return e.next=11,te["a"].getAllocation(o).then(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:j.tonnageAllocation=t.data;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){n.value=!1}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return v.provinceId=-1,v.cityId=-1,e.next=4,ee["a"].regions().then(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c.value=t.data,v.regionCode=t.data[0].code;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(V(),null==v.regionCode){e.next=8;break}return v.provinceId=-1,v.cityId=-1,h(),e.next=7,ee["a"].regionProvinces(v.regionCode).then((function(e){i.value=e.data}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(V(),null==v.provinceId){e.next=7;break}return v.cityId=-1,h(),e.next=6,ee["a"].regionProducerArea(v.provinceId).then((function(e){l.value=e.data}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return h(),e.abrupt("return",v);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(e){u.value=!0,d.value=e},C=function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:p.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(m["a"])(regeneratorRuntime.mark((function e(){var t,n,o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=d.value,n=t.producer_code,o=t.province_id,r=t.city_id,e.next=3,E["a"].setAllocation({registration_period_id:v.periodId,producer_code:n,province_id:o,city_id:r,total_distributor:s.notes}).then((function(e){O.value.refreshDataGrid(),f.value.refreshDataGrid(),b.a.success({title:"Data berhasil disimpan",position:"bottom-right"})})).catch((function(e){b.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})}));case 3:s.notes="",d.value=null,u.value=!1;case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){O.value.refreshDataGrid(),f.value.refreshDataGrid()};return{tonnageAllocationLoading:n,distributorAllocationLoading:t,allocationData:j,registrationPeriod:o,registrationPeriods:r,loading:e,producers:a,regions:c,provinces:i,cities:l,filter:v,getRegions:k,getProvinces:x,getCities:y,getAllocation:h,dialogVisible:u,openAllocationFormDialog:_,updateTable:w,dialogData:d,dialogFormData:s,submitAllocationForm:C,allocatedDataGrid:f,unallocatedDataGrid:O,refreshDataGrid:V,filterFulfilled:Object(g["a"])((function(){return null!=v.periodId&&null!=v.producerCode&&null!=v.regionCode&&null!=v.provinceId&&null!=v.cityId}))}}});const _e=X()(we,[["render",s]]);t["default"]=_e},dd4e:function(e,t,n){"use strict";var o=n("c953"),r=function(e){return o["a"].post("/distributor-recommendations",e)},a=function(e){return o["a"].post("/distributor-recommendations-multi",e)},c=function(e){return o["a"].post("/distributor-recommendation-approvals",e)};t["a"]={setRecommendation:r,setMultipleRecommendation:a,setRecommendationApproval:c}},eeae:function(e,t,n){"use strict";var o=n("c953"),r=function(e){return o["a"].post("/distributor-allocations",e)},a=function(e){return o["a"].get("/get-allocation/distributor".concat(e))},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o["a"].post("/distributor-allocations/".concat(t,"/is-allocation-full"),e)};t["a"]={setAllocation:r,getAllocation:a,isAllocationFull:c}},fb27:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return f}));n("99af");var o=n("c953"),r="/distributor-regions",a=function(){return o["a"].get(r+"/regions")},c=function(){return o["a"].get(r+"/regions_by_vp")},i=function(){return o["a"].get(r+"/regions_by_wilayah")},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return o["a"].get(r+"/regions_by_anper/".concat(e))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return o["a"].get(r+"/regions-province/".concat(e))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o["a"].get(r+"/regions-province-anper/".concat(e,"/").concat(t))},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return o["a"].get(r+"/producer-area/".concat(e))},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o["a"].get(r+"/producer-area-anper/".concat(e,"/").concat(t))},b=function(e){return o["a"].post(r,e)},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return o["a"].put(r+"/".concat(e),t)},g=function(e){return o["a"].delete(r+"/".concat(e))},f=function(e){return o["a"].post(r+"/".concat(e,"/verify"))};t["a"]={regions:a,regions_by_vp:c,regions_by_wilayah:i,regions_by_anper:l,regionProvinces:u,regionProvincesAnper:d,regionProducerArea:s,regionProducerAreaAnper:p,addDistributorRegions:b,updateDistributorRegions:m,deleteDistributorRegion:g,verifyDistributorRegion:f}}}]);