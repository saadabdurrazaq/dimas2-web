(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5484684c"],{"15fd":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("a4d3"),a("b64b");function n(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}function o(e,t){if(null==e)return{};var a,o,r=n(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}},b586:function(e,t,a){"use strict";a.r(t);var n=a("7a23"),o={class:"grid grid-cols-12 gap-6"};function r(e,t,a,r,i,c){var l=Object(n["resolveComponent"])("KioskPerfomanceReportsPanel"),u=Object(n["resolveDirective"])("loading");return Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["withDirectives"])(Object(n["createVNode"])("div",o,[e.loading?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:0,evaluationPeriod:e.evaluationPeriod},null,8,["evaluationPeriod"]))],512),[[u,e.loading]])])}var i=a("1da1"),c=(a("96cf"),{class:"intro-y col-span-12 lg:col-span-12"}),l={class:"p-5"},u={class:""},s={class:"sm:grid grid-cols-2 gap-5 mt-3"},d={class:"mt-3"},p={class:"sm:grid grid-cols gap-5"},f=Object(n["createTextVNode"])("Click to upload"),b={class:"flex w-full px-5"},m={key:1,class:"ml-auto"},v={key:1};function O(e,t,a,o,r,i){var O=Object(n["resolveComponent"])("el-option"),g=Object(n["resolveComponent"])("el-select"),j=Object(n["resolveComponent"])("form-item"),k=Object(n["resolveComponent"])("el-button"),h=Object(n["resolveComponent"])("el-upload"),w=Object(n["resolveComponent"])("DataGrid"),_=Object(n["resolveComponent"])("document-form-penilaian"),D=Object(n["resolveDirective"])("loading");return Object(n["openBlock"])(),Object(n["createBlock"])("div",c,[Object(n["withDirectives"])(Object(n["createVNode"])(_,{title:"Kinerja Kios",evaluationPeriod:e.evaluationPeriod,itemType:e.EvaluationAspectType.KioskPerformance},{default:Object(n["withCtx"])((function(a){var o=a.allowManage;return[Object(n["createVNode"])("div",l,[Object(n["createVNode"])("div",u,[Object(n["createVNode"])("div",s,[Object(n["createVNode"])(j,{label:"Nama Kios","rules-text":"Required",validationData:e.validate.kiosk_id,class:"intro-y"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(g,{modelValue:e.formData.kiosk_id,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.formData.kiosk_id=t}),class:["form-control",{"border-theme-6":e.validate.kiosk_id.$error}],filterable:""},{default:Object(n["withCtx"])((function(){return[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.distributor_kiosks,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:e.id,label:e.kiosk_name+" ("+e.kiosk_code+")",value:e.kiosk_code},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","class"])]})),_:1},8,["validationData"]),Object(n["createVNode"])(j,{label:"Nilai Kios",validationData:e.validate.kiosk_score},{default:Object(n["withCtx"])((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("input",{type:"number",placeholder:"",class:["form-control w-full",{"border-theme-6":e.validate.kiosk_score.$error}],pattern:"\\d*",maxlength:"16","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.validate.kiosk_score.$model=t})},null,2),[[n["vModelText"],e.validate.kiosk_score.$model]])]})),_:1},8,["validationData"])])]),Object(n["createVNode"])("div",d,[Object(n["createVNode"])("div",p,[Object(n["createVNode"])(j,{label:"Laporan Kinerja Kios",validationData:e.validate.report_file_path},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(h,{ref:"elUpload",class:"upload-demo",action:e.env["VUE_APP_API_ENDPOINT"]+"/files",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},"with-credentials":!0,"on-success":e.onReportUploadSuccess,"file-list":null!=e.formData.report_file_path?[{name:"file laporan kinerja kios",url:e.formData.report_file_path}]:[],"on-preview":e.handlePreview},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(k,{size:"small",type:"primary"},{default:Object(n["withCtx"])((function(){return[f]})),_:1})]})),_:1},8,["action","on-success","file-list","on-preview"])]})),_:1},8,["validationData"])])])]),Object(n["createVNode"])("div",b,[e.updateMode?(Object(n["openBlock"])(),Object(n["createBlock"])("button",{key:0,type:"button",class:"btn btn-outline-secondary mr-2",onClick:t[3]||(t[3]=function(){var t;return e.dataGrid.clearSelection&&(t=e.dataGrid).clearSelection.apply(t,arguments)})}," Clear Selection ")):Object(n["createCommentVNode"])("",!0),o?(Object(n["openBlock"])(),Object(n["createBlock"])("div",m,[e.updateMode?(Object(n["openBlock"])(),Object(n["createBlock"])("button",{key:0,disabled:e.loading,class:[{"cursor-not-allowed":e.loading},"btn btn-primary w-24 mr-2"],type:"button",onClick:t[4]||(t[4]=function(){return e.save&&e.save.apply(e,arguments)})}," Save ",10,["disabled"])):(Object(n["openBlock"])(),Object(n["createBlock"])("div",v,[Object(n["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary w-24 mr-2",onClick:t[5]||(t[5]=function(){return e.resetFormData&&e.resetFormData.apply(e,arguments)})}," Reset "),Object(n["createVNode"])("button",{disabled:e.loading,class:[{"cursor-not-allowed":e.loading},"btn bg-theme-9 text-white w-24"],type:"button",onClick:t[6]||(t[6]=function(){return e.add&&e.add.apply(e,arguments)})}," Add ",10,["disabled"])]))])):Object(n["createCommentVNode"])("",!0)]),Object(n["createVNode"])(w,{ref:"dataGrid",class:"m-5",allowManage:o,onSelectionChanged:e.onSelectionChanged},null,8,["allowManage","onSelectionChanged"])]})),_:1},8,["evaluationPeriod","itemType"]),[[D,e.loading]])])}a("0cfa");var g=a("5040"),j=a.n(g),k=a("15fd"),h=a("5530"),w=(a("d3b7"),a("84df"));function _(e,t,a,o,r,i){var c=Object(n["resolveComponent"])("DxColumn"),l=Object(n["resolveComponent"])("DxPaging"),u=Object(n["resolveComponent"])("DxPager"),s=Object(n["resolveComponent"])("DxDataGrid");return Object(n["openBlock"])(),Object(n["createBlock"])(s,{ref:"root","data-source":e.store,"show-borders":!0,"remote-operations":!0,selection:{mode:"single"},onSelectionChanged:e.onSelectionChanged,onToolbarPreparing:t[1]||(t[1]=function(t){return e.onToolbarPreparing(t)}),"allow-column-reordering":!0,"allow-column-resizing":!0,"column-auto-width":!0},{filePath:Object(n["withCtx"])((function(t){var a=t.data;return[Object(n["createVNode"])("a",{href:e.env["VUE_APP_API_ENDPOINT"]+"/files?filePath="+a.data.report_file_path,class:"btn btn-sm bg-theme-9 rounded-lg text-white",target:"_blank"},"File Laporan",8,["href"])]})),cellTemplate:Object(n["withCtx"])((function(t){var a=t.data;return[Object(n["createVNode"])("button",{onClick:function(t){return e.destroy(a.data.id)},class:"btn btn-sm bg-theme-6 rounded-lg text-white"}," Delete ",8,["onClick"])]})),default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(c,{"data-field":"kiosk.kiosk_name","data-type":"string",caption:"Nama Kios"}),Object(n["createVNode"])(c,{"data-field":"report_file_path","data-type":"string",caption:"File Laporan Kinerja","cell-template":"filePath"}),"distributor"==e.route.meta.role&&e.allowManage?(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:0,allowFiltering:!1,width:100,"data-field":"id",caption:"Aksi","cell-template":"cellTemplate"})):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(l,{"page-size":5}),Object(n["createVNode"])(u,{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20]})]})),_:1},8,["data-source","onSelectionChanged"])}var D=a("ade3"),x=(a("99af"),a("fb6a"),a("d30a")),C=a("2597"),y=a.n(C),P=a("c953"),V="/kiosk-performance-reports",N=function(){return P["a"].get(V)},S=function(e){return P["a"].post(V,e)},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return P["a"].delete(V+"/".concat(e))},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return P["a"].put(V+"/".concat(e),t)},T=function(){return P["a"].get("get-all-kiosk/")},F=function(e){return P["a"].get("get-all-kiosk/"+e)},G={get:N,add:S,update:B,destroy:R,get_kiosk:T,get_kiosk_distributor:F},K=a("6c02"),M=a("2611"),A=Object(n["defineComponent"])({components:{DxDataGrid:x["DxDataGrid"],DxColumn:x["DxColumn"],DxPaging:x["DxPaging"],DxPager:x["DxPager"],DxSorting:x["DxSorting"],DxHeaderFilter:x["DxHeaderFilter"],DxFilterRow:x["DxFilterRow"]},emits:["selectionChanged","openVerificationDialog"],props:["allowManage"],setup:function(e,t){var a=this,o=t.emit,r=Object(n["ref"])(null),c=Object(K["c"])(),l=Object(M["a"])();function u(e){return void 0!==e&&null!==e&&""!==e}Object(n["onMounted"])((function(){}));var s=Object(n["inject"])("env"),d=new y.a({key:"id",load:function(e){var t="?";["skip","take","requireTotalCount","requireGroupCount","sort","filter","totalSummary","group","groupSummary"].forEach((function(a){a in e&&u(e[a])&&(t+="".concat(a,"=").concat(JSON.stringify(e[a]),"&"))})),t=t.slice(0,-1),"admin"==c.meta.role&&(t+="&distributor_id=".concat(c.params.distributor_id));var a="".concat(s["VUE_APP_API_ENDPOINT"],"/kiosk-performance-reports").concat(t);return P["a"].get(a).then((function(e){return e.data})).catch((function(){throw"Data Loading Error"}))}}),p=(Object(n["inject"])("updateFormData"),function(e){var t=e.selectedRowsData;o("selectionChanged",t[0])}),f=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:l.$confirm("Hapus data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,G.destroy(t).then((function(e){j.a.success({title:"Success",position:"bottom-right"}),b()})).catch((function(e){j.a.error({title:"Failed",position:"bottom-right"})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(){}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){r.value.instance.refresh()},m=function(){r.value.instance.clearSelection()},v=function(e){e.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"refresh",onClick:b.bind(a)}})},O=function(e,t){e.recommended=t,o("openVerificationDialog",e)};return Object(D["a"])({env:s,route:c,store:d,onSelectionChanged:p,destroy:f,onToolbarPreparing:v,refreshDataGrid:b,clearSelection:m,root:r,openVerificationDialog:O},"route",c)}}),E=a("6b0d"),$=a.n(E);const I=$()(A,[["render",_]]);var U=I,L=a("3c6f"),q={id:null,kiosk_id:null,report_file_path:null,kiosk_score:null,evaluation_period_id:null,kuartal:null},z=a("25a0"),H=a("e3e1"),J=a("2022"),X=a("5502"),W=["id"],Q=["id"],Y=Object(n["defineComponent"])({components:{DocumentFormPenilaian:w["a"],FormItem:J["a"],DataGrid:U},props:["evaluationPeriod"],setup:function(e){var t=Object(K["c"])(),a=Object(X["d"])(),o=a.state.auth.user,r=Object(n["ref"])(!1),c=Object(n["ref"])(!1),l=Object(M["a"])(),u=Object(n["ref"])(null),s=Object(n["ref"])(null),d=Object(n["inject"])("env"),p=Object(n["reactive"])(Object(h["a"])({},q)),f={kiosk_id:{required:H["c"]},report_file_path:{required:H["c"]},kiosk_score:{required:H["c"]}},b=Object(z["a"])(f,Object(n["toRefs"])(p)),m=function(){for(var e in q)p[e]=q[e];b.value.$reset(),y()},v=function(e){var t=Object(n["toRefs"])(p);for(var a in q)Object.hasOwnProperty.call(e,a)&&(t[a].value=e[a])},O=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:null!=t?(v(t),r.value=!0):(m(),r.value=!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:b.value.$touch(),b.value.$invalid?j.a.error({title:"Submit Gagal",message:"Silahkan periksa form sekali lagi",position:"bottom-right"}):l.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return p.id,t=Object(k["a"])(p,W),t.distributor_id=o.distributor.id,c.value=!0,e.next=5,G.update(p.id,t).then((function(e){j.a.success({title:"Data berhasil disimpan",position:"bottom-right"}),u.value.clearSelection(),u.value.refreshDataGrid(),m()})).catch((function(e){j.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})})).finally((function(){c.value=!1}));case 5:case"end":return e.stop()}}),e)})))).catch((function(){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:b.value.$touch(),b.value.$invalid?j.a.error({title:"Submit Gagal",message:"Silahkan periksa form sekali lagi",position:"bottom-right"}):l.$confirm("Simpan data. Lanjutkan?","Konfirmasi",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",closeOnClickModal:!1}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return p.id,t=Object(k["a"])(p,Q),t.distributor_id=o.distributor.id,c.value=!0,e.next=5,G.add(t).then((function(e){j.a.success({title:"Data berhasil disimpan",position:"bottom-right"}),s.value.clearFiles(),u.value.refreshDataGrid(),m()})).catch((function(e){j.a.error({title:"Data gagal disimpan",message:"Silahkan periksa form sekali lagi",position:"bottom-right"})})).finally((function(){c.value=!1}));case 5:case"end":return e.stop()}}),e)})))).catch((function(){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(e,t,a){p.report_file_path=e.id},D=function(e){var t=window.open(d["VUE_APP_API_ENDPOINT"]+"/files?filePath="+e.url,"_blank");t.focus()};function x(e){O(e)}Object(n["provide"])("updateFormData",O);var C=Object(n["ref"])([]);Object(n["onMounted"])(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("admin"!=t.meta.role){e.next=5;break}return e.next=3,G.get_kiosk_distributor(t.params.distributor_id).then((function(e){C.value=e.data.data}));case 3:e.next=7;break;case 5:return e.next=7,G.get_kiosk().then((function(e){C.value=e.data.data})).finally((function(){}));case 7:y();case 8:case"end":return e.stop()}}),e)}))));var y=function(){p.evaluation_period_id=e.evaluationPeriod.id,p.kuartal=e.evaluationPeriod.active_kuartal},P=Object(n["ref"])(!1),V=Object(n["ref"])(null),N=Object(n["reactive"])({notes:""}),S=function(e){P.value=!0,V.value=e},R=function(){u.value.refreshDataGrid()};return{env:d,formData:p,validate:b,dataGrid:u,updateMode:r,loading:c,save:g,add:w,resetFormData:m,onReportUploadSuccess:_,elUpload:s,handlePreview:D,onSelectionChanged:x,dialogVisible:P,dialogData:V,dialogFormData:N,openVerificationDialog:S,refreshDataGrid:R,distributor_kiosks:C,EvaluationAspectType:L["a"]}},data:function(){return{}}});const Z=$()(Y,[["render",O]]);var ee=Z,te=a("730f"),ae=Object(n["defineComponent"])({components:{KioskPerfomanceReportsPanel:ee},setup:function(){var e=Object(n["ref"])(null),t=Object(n["ref"])(!0);return Object(n["onMounted"])(Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.value=!0,a.next=3,te["a"].getActive().then((function(t){e.value=t.data}));case 3:t.value=!1;case 4:case"end":return a.stop()}}),a)})))),{evaluationPeriod:e,loading:t}}});const ne=$()(ae,[["render",r]]);t["default"]=ne}}]);